<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8. Testing &mdash; CIME 5.6 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CIME 5.6 documentation" href="../index.html" />
    <link rel="up" title="Case Control System Part 1: Basic Usage" href="index.html" />
    <link rel="next" title="9. Fortran Unit Testing" href="unit_testing.html" />
    <link rel="prev" title="7. Timers and timing" href="timers.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="unit_testing.html" title="9. Fortran Unit Testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timers.html" title="7. Timers and timing"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CIME 5.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Case Control System Part 1: Basic Usage</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="testing">
<span id="id1"></span><h1>8. Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="../Tools_user/create_test.html">create_test</a> is the tool we use to test both CIME and CIME-driven models. It can be used as an easy way to
run a single basic test or an entire suite of tests that are run in parallel for improved performance.
<a class="reference external" href="../Tools_user/create_test.html">create_test</a>  is the driver behind the automated nightly testing of CIME-driven models.</p>
<div class="section" id="testname-syntax">
<h2>8.1. Testname syntax<a class="headerlink" href="#testname-syntax" title="Permalink to this headline">¶</a></h2>
<p>Tests come in the forms:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">TESTTYPE</span><span class="p">[</span><span class="n">_MODIFIERS</span><span class="p">]</span><span class="o">.</span><span class="n">GRID</span><span class="o">.</span><span class="n">COMPSET</span><span class="p">[</span><span class="o">.</span><span class="n">MACHINE_COMPILER</span><span class="p">[</span><span class="o">.</span><span class="n">TESTMODS</span><span class="p">]]</span>
</pre></div>
</div>
<p>Where</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">TESTTYPE</span></code></dt>
<dd><p class="first last">How you want to do the test. Options for this value are listed in config_tests.xml.
A common test type would be ERS which stands for exact restart, which means you want to test the
grid and compset to see if they reproduce the same result upon restart as they would if no restart
took place.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">MODIFIERS</span></code></dt>
<dd><p class="first">These are changes to the default settings for the test.</p>
<p>The currently accepted modifiers are:</p>
<div class="last line-block">
<div class="line"><code class="docutils literal"><span class="pre">_LdN</span></code>, <code class="docutils literal"><span class="pre">_LnN</span></code>, <code class="docutils literal"><span class="pre">_LyN</span></code> - this changes the default length of the test.
<code class="docutils literal"><span class="pre">N</span></code> is an integer, <code class="docutils literal"><span class="pre">d</span></code> is day, <code class="docutils literal"><span class="pre">n</span></code> is timestep and <code class="docutils literal"><span class="pre">y</span></code> is year.  <code class="docutils literal"><span class="pre">_Ld3</span></code> would specify that the test is modified to be a 3 day test.</div>
<div class="line"><code class="docutils literal"><span class="pre">_D</span></code> - this sets the xml variable <code class="docutils literal"><span class="pre">DEBUG</span></code> to TRUE.</div>
<div class="line"><code class="docutils literal"><span class="pre">_IOP</span></code> - this turns on pnetcdf for the PIO backend.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">GRID</span></code></dt>
<dd><p class="first last">The model grid (can be an alias)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">COMPSET</span></code></dt>
<dd><p class="first last">The compset name (can be an alias)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">MACHINE_COMPILER</span></code></dt>
<dd><p class="first last">This is optional; <a class="reference external" href="../Tools_user/create_test.html">create_test</a>  will probe
the underlying machine and use the default compiler for that machine if this value is not
supplied.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">TESTMODS</span></code></dt>
<dd><p class="first last">This is optional. This points to a directory with  <code class="docutils literal"><span class="pre">user_nl_xxx</span></code> files or a <code class="docutils literal"><span class="pre">shell_commands</span></code> that can be used to provide test specific case modifications for the test.</p>
</dd>
</dl>
</li>
</ul>
<p>To see the available tests for your model, call <a class="reference external" href="../Tools_user/query_tests.html">query_tests</a>.</p>
</div>
<div class="section" id="test-types">
<h2>8.2. Test Types<a class="headerlink" href="#test-types" title="Permalink to this headline">¶</a></h2>
<p>The following are the type of tests that are supported by CIME:</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERS</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup (default 6 days + 5 days).</div>
<div class="line">Do an 11 day initial test - write a restart at day 6.    (file suffix: base)</div>
<div class="line">Do a 5 day restart test, starting from restart at day 6. (file suffix: rest)</div>
<div class="line">Compare component history files &#8216;.base&#8217; and &#8216;.rest&#8217; at day 11.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERS2</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup  (default 6 days + 5 days).</div>
<div class="line">Do an 11 day initial test without making restarts.     (file suffix: base)</div>
<div class="line">Do an 11 day restart test stopping at day 6 with a restart, then resuming from restart at day 6. (file suffix: rest)</div>
<div class="line">Compare component history files &#8221;.base&#8221; and &#8221;.rest&#8221; at day 11.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERT</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup, default 2 month + 1 month (ERS with info DBUG = 1).</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">IRT</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup, (default 4 days + 7 days) with restart from interim file.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERIO</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup with different PIO methods, (default 6 days + 5 days).</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERR</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup with resubmit, (default 4 days + 3 days).</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERRI</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Exact restart from startup with resubmit, (default 4 days + 3 days). Tests incomplete logs option for st_archive.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERI</span></code></dt>
<dd><div class="first last line-block">
<div class="line">hybrid/branch/exact restart test, default (by default STOP_N is 22 days)</div>
<div class="line">ref1case: Do an initial run for 3 days writing restarts at day 3. ref1case is a clone of the main case. Short term archiving is on.</div>
<div class="line">ref2case (Suffix hybrid): Do a hybrid run for default 19 days running with ref1 restarts from day 3, and writing restarts at day 10.
ref2case is a clone of the main case. Short term archiving is on.</div>
<div class="line">case: Do a branch run, starting from restarts written in ref2case, for 9 days and writing restarts at day 5. Short term archiving is off.</div>
<div class="line">case (Suffix base): Do a restart run from the branch run restarts for 4 days. Then ompare component history files &#8216;.base&#8217; and &#8216;.hybrid&#8217; at day 19.
Short term archiving is off.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ERP</span></code></dt>
<dd><div class="first last line-block">
<div class="line">PES counts hybrid (OPENMP/MPI) restart bit for bit test from startup, (default 6 days + 5 days).</div>
<div class="line">Initial PES set up out of the box.</div>
<div class="line">Do an 11 day initial test - write a restart at day 6.     (file suffix base)</div>
<div class="line">Half the number of tasks and threads for each component.</div>
<div class="line">Do a 5 day restart test starting from restart at day 6. (file suffix rest)</div>
<div class="line">Compare component history files &#8216;.base&#8217; and &#8216;.rest&#8217; at day 11.</div>
<div class="line">This is just like an ERS test but the tasks/threading counts are modified on restart.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PEA</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Single PE bit for bit test (default 5 days)</div>
<div class="line">Do an initial run on 1 PE with mpi library.     (file suffix: base)</div>
<div class="line">Do the same run on 1 PE with mpiserial library. (file suffix: mpiserial)</div>
<div class="line">Compare base and mpiserial.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PEM</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Modified PE counts for MPI(NTASKS) bit for bit test (default 5 days)</div>
<div class="line">Do an initial run with default PE layout                               (file suffix: base)</div>
<div class="line">Do another initial run with modified PE layout (NTASKS_XXX =&gt; NTASKS_XXX/2)  (file suffix: modpes)</div>
<div class="line">Compare base and modpes</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PET</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Modified threading OPENMP bit for bit test (default 5 days)</div>
<div class="line">Do an initial run where all components are threaded by default. (file suffix: base)</div>
<div class="line">Do another initial run with NTHRDS=1 for all components.        (file suffix: single_thread)</div>
<div class="line">Compare base and single_thread.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PFS</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Performance test setup. History and restart output is turned off. (default 20 days)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ICP</span></code></dt>
<dd><div class="first last line-block">
<div class="line">CICE performance test.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">OCP</span></code></dt>
<dd><div class="first last line-block">
<div class="line">POP performance test. (default 10 days)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">MCC</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Multi-driver validation vs single-instance. (default 5 days)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">NCK</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Multi-instance validation vs single instance - sequential PE for instances (default length)</div>
<div class="line">Do an initial run test with NINST 1. (file suffix: base)</div>
<div class="line">Do an initial run test with NINST 2. (file suffix: multiinst for both _0001 and _0002)</div>
<div class="line">Compare base and _0001 and _0002.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">REP</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Reproducibility: Two identical runs are bit for bit. (default 5 days)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">SBN</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Smoke build-namelist test (just run preview_namelist and check_input_data).</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">SMS</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Smoke startup test (default 5 days)</div>
<div class="line">Do a 5 day initial test. (file suffix: base)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">SEQ</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Different sequencing bit for bit test. (default 10 days)</div>
<div class="line">Do an initial run test with out-of-box PE-layout. (file suffix: base)</div>
<div class="line">Do a second run where all root pes are at pe-0.   (file suffix: seq)</div>
<div class="line">Compare base and seq.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">DAE</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Data assimilation test, default 1 day, two DA cycles, no data modification.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PRE</span></code></dt>
<dd><div class="first last line-block">
<div class="line">Pause-resume test: by default a bit for bit test of pause-resume cycling.</div>
<div class="line">Default 5 hours, five pause/resume cycles, no data modification.</div>
</div>
</dd>
</dl>
</li>
</ul>
<p>Each test run by <a class="reference external" href="../Tools_user/create_test.html">create_test</a>  includes the following mandatory steps:</p>
<ul class="simple">
<li>CREATE_NEWCASE: creating the create</li>
<li>XML: xml changes to case based on test settings</li>
<li>SETUP: setup case (case.setup)</li>
<li>SHAREDLIB_BUILD: build sharedlibs</li>
<li>MODEL_BUILD: build module (case.build)</li>
<li>SUBMIT: submit test (case.submit)</li>
<li>RUN: run test test</li>
</ul>
<p>And the following optional phases:</p>
<ul class="simple">
<li>NLCOMP: Compare case namelists against baselines</li>
<li>THROUGHPUT: Compare throughput against baseline throughput</li>
<li>MEMCOMP: Compare memory usage against baseline memory usage</li>
<li>MEMLEAK: Check for memleak</li>
<li>COMPARE: Used to track test-specific comparions, for example, an ERS test would have a COMPARE_base_rest phase representing the check that the base result matched the restart result.</li>
<li>GENERATE: Generate baseline results</li>
<li>BASELINE: Compare results against baselines</li>
</ul>
<p>Each test may be in one of the following states:</p>
<ul class="simple">
<li>PASS: The phase was executed successfully</li>
<li>FAIL: We attempted to execute this phase, but it failed. If this phase is mandatory, no further progress will be made on this test. A detailed explanation of the failure should be in TestStatus.log.</li>
<li>PEND: This phase will be run or is currently running but not complete</li>
</ul>
<p>The current state of a test is represented in the file $CASEROOT/TestStatus</p>
<p>All output from the CIME infrastructure regarding this test will be put in the file $CASEROOT/TestStatus.log</p>
<p>A cs.status.$testid script will be put in the test root. This script will allow you to see the
current status of all your tests.</p>
<div class="section" id="using-create-test-e3sm">
<h3>8.2.1. Using <strong>create_test</strong> (E3SM)<a class="headerlink" href="#using-create-test-e3sm" title="Permalink to this headline">¶</a></h3>
<p>Usage will differ slightly depending on if you&#8217;re using E3SM or CESM.</p>
<p>Using examples to illustrate common use cases</p>
<p>To run a test:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span>
</pre></div>
</div>
<p>To run a test with a non-default compiler:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">--</span><span class="n">compiler</span> <span class="n">intel</span>
</pre></div>
</div>
<p>To run a test with baseline comparisons against baseline name &#8216;master&#8217;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span>
</pre></div>
</div>
<p>To run a test and update baselines with baseline name &#8216;master&#8217;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span>
</pre></div>
</div>
<p>To run a test with a non-default test-id:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span><span class="n">t</span> <span class="n">my_test_id</span>
</pre></div>
</div>
<p>To run a test and use a non-default test-root for your case dir:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>./create_test SMS.f19_f19.A -t $test_root
</pre></div>
</div>
<p>To run a test and use and put case, build, and run dirs all in the same root:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>./create_test SMS.f19_f19.A --output-root $output_root
</pre></div>
</div>
<p>To run a test and force it to go into a certain batch queue:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span><span class="n">q</span> <span class="n">myqueue</span>
</pre></div>
</div>
<p>To run a test and use a non-default project (can impact things like directory paths and acct for batch system):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span><span class="n">p</span> <span class="n">myproj</span>
</pre></div>
</div>
<p>To run two tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">B</span>
</pre></div>
</div>
<p>To run a test suite:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">e3sm_developer</span>
</pre></div>
</div>
<p>To run a test suite excluding a specific test:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">create_test</span> <span class="n">e3sm_developer</span> <span class="o">^</span><span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span>
</pre></div>
</div>
<p>See create_test -h for the full list of options</p>
<p>Interpreting test output is pretty easy, looking at an example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="o">./</span><span class="n">create_test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span>

<span class="n">Creating</span> <span class="n">test</span> <span class="n">directory</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jgfouca</span><span class="o">/</span><span class="n">e3sm</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span><span class="o">.</span><span class="mi">20170504</span><span class="n">_163152_31aahy</span>
<span class="n">RUNNING</span> <span class="n">TESTS</span><span class="p">:</span>
  <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span>
<span class="n">Starting</span> <span class="n">CREATE_NEWCASE</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">CREATE_NEWCASE</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">4.170537</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span>
<span class="n">Starting</span> <span class="n">XML</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">XML</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">0.735993</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span>
<span class="n">Starting</span> <span class="n">SETUP</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">SETUP</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">11.544286</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span>
<span class="n">Starting</span> <span class="n">SHAREDLIB_BUILD</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">SHAREDLIB_BUILD</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">82.670667</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span>
<span class="n">Starting</span> <span class="n">MODEL_BUILD</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">4</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">MODEL_BUILD</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">18.613263</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span>
<span class="n">Starting</span> <span class="n">RUN</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="k">with</span> <span class="mi">64</span> <span class="n">procs</span>
<span class="n">Finished</span> <span class="n">RUN</span> <span class="k">for</span> <span class="n">test</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="ow">in</span> <span class="mf">35.068546</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">PASS</span><span class="p">)</span><span class="o">.</span> <span class="p">[</span><span class="n">COMPLETED</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">At</span> <span class="n">test</span><span class="o">-</span><span class="n">scheduler</span> <span class="n">close</span><span class="p">,</span> <span class="n">state</span> <span class="ow">is</span><span class="p">:</span>
<span class="n">PASS</span> <span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span> <span class="n">RUN</span>
  <span class="n">Case</span> <span class="nb">dir</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jgfouca</span><span class="o">/</span><span class="n">e3sm</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">SMS</span><span class="o">.</span><span class="n">f19_f19</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">melvin_gnu</span><span class="o">.</span><span class="mi">20170504</span><span class="n">_163152_31aahy</span>
<span class="n">test</span><span class="o">-</span><span class="n">scheduler</span> <span class="n">took</span> <span class="mf">154.780044079</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>You can see that <a class="reference external" href="../Tools_user/create_test.html">create_test</a>  informs the user of the case directory and of the progress and duration
of the various test phases.</p>
</div>
<div class="section" id="managing-baselines">
<h3>8.2.2. Managing baselines<a class="headerlink" href="#managing-baselines" title="Permalink to this headline">¶</a></h3>
<p>A big part of testing is managing your baselines (sometimes called gold results). We have provided
tools to help the user do this without having to repeat full runs of test cases with <a class="reference external" href="../Tools_user/create_test.html">create_test</a> .</p>
<p>bless_test_results: Takes a batch of cases of tests that have already been run and copy their
results to a baseline area.</p>
<p>compare_test_results: Takes a batch of cases of tests that have already been run and compare their
results to a baseline area.</p>
<p>Take a batch of results for the jenkins user for the testid &#8216;mytest&#8217; and copy the results to
baselines for &#8216;master&#8217;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">bless_test_results</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="n">e3sm</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span> <span class="o">-</span><span class="n">t</span> <span class="n">mytest</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span>
</pre></div>
</div>
<p>Take a batch of results for the jenkins user for the testid &#8216;mytest&#8217; and compare the results to
baselines for &#8216;master&#8217;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">compare_test_results</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="n">e3sm</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span> <span class="o">-</span><span class="n">t</span> <span class="n">mytest</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-tests">
<h3>8.2.3. Adding tests<a class="headerlink" href="#adding-tests" title="Permalink to this headline">¶</a></h3>
<p>Open the config/$model/tests.py file, you&#8217;ll see a python dict at the top
of the file called _TESTS, find the test category you want to
change in this dict and add your testcase to the list.  Note the
comment at the top of this file indicating that you add a test with
this format: test&gt;.&lt;grid&gt;.&lt;compset&gt;, and then there is a second
argument for mods.</p>
</div>
<div class="section" id="scripts-regression-tests">
<span id="id7"></span><h3>8.2.4. Scripts regression tests<a class="headerlink" href="#scripts-regression-tests" title="Permalink to this headline">¶</a></h3>
<p><strong>$CIMEROOT/scripts/tests/scripts_regression_tests.py</strong> is the suite of internal tests we run
for the stand-alone CIME testing. With no arguments, it will run the full suite. You can limit testing to a specific
test class or even a specific test within a test class.</p>
<p>Run full suite:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">scripts_regression_tests</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run a test class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">scripts_regression_tests</span><span class="o">.</span><span class="n">py</span> <span class="n">K_TestCimeCase</span>
</pre></div>
</div>
<p>Run a specific test:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">scripts_regression_tests</span><span class="o">.</span><span class="n">py</span> <span class="n">K_TestCimeCase</span><span class="o">.</span><span class="n">test_cime_case</span>
</pre></div>
</div>
<p>If a test fails, the unittest module that drives scripts_regression_tests wil note the failure, but
won&#8217;t print the output of the test until testing has completed. When there are failures for a
test, the case directories for that test will not be cleaned up so that the user can do a post-mortem
analysis. The user will be notified of the specific directories that will be left for them to
examine.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8. Testing</a><ul>
<li><a class="reference internal" href="#testname-syntax">8.1. Testname syntax</a></li>
<li><a class="reference internal" href="#test-types">8.2. Test Types</a><ul>
<li><a class="reference internal" href="#using-create-test-e3sm">8.2.1. Using <strong>create_test</strong> (E3SM)</a></li>
<li><a class="reference internal" href="#managing-baselines">8.2.2. Managing baselines</a></li>
<li><a class="reference internal" href="#adding-tests">8.2.3. Adding tests</a></li>
<li><a class="reference internal" href="#scripts-regression-tests">8.2.4. Scripts regression tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="timers.html"
                        title="previous chapter">7. Timers and timing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="unit_testing.html"
                        title="next chapter">9. Fortran Unit Testing</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/users_guide/testing.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="unit_testing.html" title="9. Fortran Unit Testing"
             >next</a> |</li>
        <li class="right" >
          <a href="timers.html" title="7. Timers and timing"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CIME 5.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Case Control System Part 1: Basic Usage</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2017, U.S. National Science Foundation and U.S. Department of Energy.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.3.
    </div>
  </body>
</html>